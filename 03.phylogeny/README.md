# 03.phylogeny 
This folder includes the pipelines that are used to construct species phylogeny.

The abbreviations in the document are represented the species name, which is found in [species.txt](https://github.com/Dived-Jin/Gecko_Sexchromosome/blob/af3026331796bd45a6fcf1bb4dc1415eb5a400ed/species.txt).

## (1) a.get_alignment.sh
this script is used to extract the alignment from the MAF file.
```
used: sh a.get_alignment.sh <inputmafpath> <refaifile>
        inputmafpath: the MAF file which had been generated by 02.AlignmentLAST 
        format: maf1path
                maf2path 
        refaifile: reference genome fai file
        output file:
                a. generated the removed gap file with the fasta file. 
                b. The kept alignment region list; such as example/Seed.list.
                c. alignment file with PHY format.
```
## (2) b.phylogeny.sh
Constructed phylogeny using iqtree2, and integrated the tree by Astral.
```
used: sh b.phylogeny.sh
    - Seedlsf: The kept alignment region list, such as example/Seed.list.
    - AlignmentPath: the path of alignment region with PHY format.
    output file:
        a. tree.list.tree: the tree list is generated by iqtree2.
        b. Gekko_24_finaltopology.nwk: the result of phylogeny with NWK.
```     
## (3) c.divergence.sh
Estimated the divergence time by mcmctree.
```
used: sh c.divergence.sh
    - Ungapfasta: then alignment file with fasta format which removed the alignment gap.
    - treefile: tree file with NWK file is generated from b.phylogeny.sh.
```

## (4) d.discovista.sh
Calculated the frequency of three topologies of each node.
```
used: sh d.discovista.sh 
    - tree.list.tree: the tree list is generated by iqtree2.
    - Gekko_24_finaltopology.nwk: the result of phylogeny with NWK.
```

## (5) e.Quible.sh:
The ILS and introgression were estimated by Quible.
```
used: sh e.Quible.sh <Seedlist> <Treelist> <phylogeny>
    - Seedlist:  kept alignment region list; such as example/Seed.list.
    - Treelist:  the tree list which is generated by iqtree2. example/tree.list.tree
    - phylogeny:  the result of phylogeny with NWK. Such as example/Gekko_24_finaltopology.nwk
    raw input:
    - sampleInputFile.txt: the control file of Quible.
    In our work, used this script as following:
        sh e.Quible.sh example/Seed.list. example/tree.list.tree example/Gekko_24_finaltopology.nwk
```
